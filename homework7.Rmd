---
title: "Homework 7"
author: "Ryan Corydon and Emma Podlich"
date: "2023-03-20"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r}
library(dplyr)
library(tidyr)
library(ggplot2)
```


```{r}
#data(happy, package="productplots")
#head(happy)
```

```{r}
HAPPY <- readRDS("data/HAPPY.rds")
```

## Part 1 (cleaning)

1. Data cleaning: the values “IAP”, “DK” and “NA” all encode missing values. Replace all of these instances by the value NA.

```{r}
HAPPY[HAPPY == "IAP" | HAPPY == "DK" | HAPPY == "NA"] <- NA
```


2. Check the type of the variable and cast into the right type (factor variable for categorical variables). For age, change “89 OR OLDER” to 89 and assume the variable should be numeric.

```{r}
str(HAPPY)
HAPPY$HAPPY <- as.factor(HAPPY$HAPPY)
HAPPY %>% ggplot(aes(x = HAPPY)) + geom_bar()

HAPPY$YEAR <- as.numeric(HAPPY$YEAR)
HAPPY %>% ggplot(aes(x = YEAR)) + geom_histogram(binwidth=1)

HAPPY$SEX <- as.factor(HAPPY$SEX)
HAPPY %>% ggplot(aes(x = SEX)) + geom_bar()

HAPPY$MARITAL <- as.factor(HAPPY$MARITAL)
HAPPY %>% ggplot(aes(x = MARITAL)) + geom_bar()

HAPPY$DEGREE <- as.factor(HAPPY$DEGREE)
HAPPY %>% ggplot(aes(x = DEGREE)) + geom_bar()

HAPPY$FINRELA <- as.factor(HAPPY$FINRELA)
HAPPY %>% ggplot(aes(x = FINRELA)) + geom_bar()

HAPPY$HEALTH <- as.factor(HAPPY$HEALTH)
HAPPY %>% ggplot(aes(x = HEALTH)) + geom_bar()

HAPPY$WTSSALL <- as.numeric(HAPPY$WTSSALL)
HAPPY %>% ggplot(aes(x = WTSSALL)) + geom_bar()

HAPPY$PARTYID <- as.factor(HAPPY$PARTYID)
HAPPY %>% ggplot(aes(x = PARTYID)) + geom_bar()

HAPPY$POLVIEWS <- as.factor(HAPPY$POLVIEWS)
HAPPY %>% ggplot(aes(x = POLVIEWS)) + geom_bar()

HAPPY[HAPPY == "89 OR OLDER"] <- "89"
HAPPY$AGE <- as.numeric(HAPPY$AGE)
HAPPY %>% ggplot(aes(x = AGE)) + geom_histogram(binwidth=1)
```



3. Bring all levels of factors into a sensible order. For marital you could e.g. order the levels according to average age.

```{r}

# HAPPY <- HAPPY %>% factor(MARITAL,
 # levels(reorder(MARITAL, AGE, mean, na.rm = TRUE))) 




```



## Part 2 Individual Exploration

### Ryan

The relationship that I want to investigate is the happiness from the years 2008-2016 of people that are married and not married.

```{r}
HAPPY1 = 
HAPPY %>% filter(YEAR > '2012') %>% filter(MARITAL == 'MARRIED' | MARITAL == 'DIVORCED') 
```

```{r}
 ggplot(HAPPY1, aes(x = YEAR))+
  geom_bar(aes(fill = MARITAL), position = "dodge") + 
  facet_wrap(~HAPPY) 
```

Looking at the data I can see in the through the years 2013 and 2016 I can clearly see that people that are married are much more happy than those that aren't. I can assume that this will be the same for all years as well but wanted to do a specific year range for fun. So if you want to be more happier in life I assume you should try and get married.

### Emma

The relationship that I would like to investigate is how happy people are based on their different sexes and marital status.

```{r}
ggplot(HAPPY, aes(x = SEX))+
  geom_bar(aes(fill = MARITAL), position = "dodge") + 
  facet_wrap(~HAPPY)
```

According to this plot, the trends in both happiness type and marital status is the same for males and females. There are few males/females in the not too happy category and all martial status' have about the same amount of males/females in this category. There are a lot of males/females in the pretty happy category and most common marital status would be married people are in this category. The least common would be separated in this category. There are a lot of males/females in the very happy category but a little bit less than the previous category (pretty happy). The most common marital status would also be married and the least common would also be separated in this category.
